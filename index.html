<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Cost Estimator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="headertpcoms"> 
        <img src="logo.png" alt="TPCOMS" style="width: 250px">
        <h4 style="color: rgb(0, 79, 163);">TPCOMS VIRTUAL PRIVATE CLOUD COST ESTIMATOR</h4>
    </div>
    <div class="main-container">
        <div class="container">
            <h2>THÔNG TIN ĐẦU VÀO</h2>
            <form id="costForm">
                <div class="label-group">
                    <label for="numVCPU">Số lượng vCPU (Core/GHz):</label>
                    <input type="number" id="numVCPU" min="1" max="500" step="1" value="0" required oninput="numVCPURange.value = this.value">
                    <input type="range" id="numVCPURange" min="1" max="500" step="1" value="0" oninput="numVCPU.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="numRAM">Số lượng RAM (GB):</label>
                    <input type="number" id="numRAM" min="1" max="2000" step="1" value="0" required oninput="numRAMRange.value = this.value">
                    <input type="range" id="numRAMRange" min="1" max="2000" step="1" value="0" oninput="numRAM.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="numSSD">Số lượng SSD vSAN (GB):</label>
                    <input type="number" id="numSSD" value="0" required oninput="numSSDRange.value = this.value">
                    <input type="range" id="numSSDRange" min="10" max="5000" step="10" value="0" oninput="numSSD.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="numHDD">Số lượng HDD SAN (GB):</label>
                    <input type="number" id="numHDD" value="0" required oninput="numHDDRange.value = this.value">
                    <input type="range" id="numHDDRange" min="10" max="10000" step="10" value="0" oninput="numHDD.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="numIPPublic">Số lượng IP Public:</label>
                    <input type="number" id="numIPPublic" min="1" max="50" step="1" value="1" required oninput="numIPPublicRange.value = this.value">
                    <input type="range" id="numIPPublicRange" min="1" max="50" step="1" value="1" oninput="numIPPublic.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="bandwidthDomestic">Băng thông trong nước (Mbps):</label>
                    <input type="number" id="bandwidthDomestic" value="100" min="1" max="10000" step="1" required oninput="bandwidthDomesticRange.value = this.value">
                    <input type="range" id="bandwidthDomesticRange" min="1" max="10000" step="1" value="100" oninput="bandwidthDomestic.value = this.value">
                </div>
                
                <div class="label-group">
                    <label for="bandwidthInternational">Băng thông quốc tế (Mbps):</label>
                    <input type="number" id="bandwidthInternational" value="4" min="1" max="1000" step="1" required oninput="bandwidthInternationalRange.value = this.value">
                    <input type="range" id="bandwidthInternationalRange" min="1" max="1000" step="1" value="4" oninput="bandwidthInternational.value = this.value">
                </div>
                <p>Dịch vụ cộng thêm:</p>
                <div class="extra-services">
                    <input type="checkbox" id="enableExtra" onchange="toggleExtraForm()">
                    <label for="enableExtra">Backup</label>
                </div>
                <div class="extra-container" id="extraContainer" style="display: none;">
                    <div class="label-group">
                        <label for="numberVM">Số lượng VM cần backup:</label>
                        <input type="number" id="numberVM" min="0" max="100" step="1" value="0" required oninput="numberVMrange.value = this.value">
                        <input type="range" id="numberVMrange" min="0" max="100" step="1" value="0" required oninput="numberVM.value = this.value">
                    </div>
                    <div class="label-group">
                        <label for="backupcapacity">Dung lượng backup (GB):</label>
                        <input type="number" id="backupcapacity" min="0" max="2000" step="1" value="0" required oninput="backupcapacityrange.value = this.value">
                        <input type="range" id="backupcapacityrange" min="0" max="500" step="1" value="0" required oninput="backupcapacity.value = this.value">
                    </div>
                </div>
                <button type="submit">Tính dự toán</button>
            </form>
            <p style="color: rgb(0, 0, 0); font-size: 14px; font-style: bold; padding-top: 10px;">Đơn giá sử dụng trong dự toán:</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Server Compute: 579,607,000 VNĐ / Server</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Hệ thống quản lý: 6,626,427,520 VNĐ</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Hệ thống SAN HDD: 1,200,000,000 VNĐ</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Băng thông trong nước: 15,625 VNĐ / Mbps / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Băng thông quốc tế: 126,000 VNĐ / Mbps / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- IP Public: 100,000 VNĐ / IP / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Băng thông trong nước: 15,625 VNĐ / Mbps / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- Rack online: 19,000,000 VNĐ / Rack / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- License Broadcom: 620,000 VNĐ / Core / tháng</p>
            <p style="color: rgb(0, 0, 0); font-size: 12px; font-style: italic;">- License Veeam: 286,000 VNĐ / VM / tháng</p>
        </div>
        <div class="result-container">
            <h2>THÔNG TIN DỰ TOÁN KỸ THUẬT</h2>
            <div id="result">
            </div>
        </div>
    </div>
    <script>
        function toggleExtraForm() {
            let extraContainer = document.getElementById('extraContainer');
            extraContainer.style.display = document.getElementById('enableExtra').checked ? 'block' : 'none';
        }
    </script>
    <script>
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', function() {
                const rangeInput = document.getElementById(this.id + 'Range');
                rangeInput.value = this.value;
            });
        });

        document.querySelectorAll('input[type="range"]').forEach(range => {
            range.addEventListener('input', function() {
                const numberInput = document.getElementById(this.id.replace('Range', ''));
                numberInput.value = this.value;
            });
        });

        document.getElementById('costForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Ngăn chặn form submit mặc định
            // Lưu từng giá trị vào biến riêng
            let numVCPU = parseInt(document.getElementById('numVCPU').value, 10);
            let numRAM = parseInt(document.getElementById('numRAM').value, 10);
            let numSSD = parseInt(document.getElementById('numSSD').value, 10);
            let numHDD = parseInt(document.getElementById('numHDD').value, 10);
            let numIPPublic = parseInt(document.getElementById('numIPPublic').value, 10);
            let bandwidthDomestic = parseInt(document.getElementById('bandwidthDomestic').value, 10);
            let bandwidthInternational = parseInt(document.getElementById('bandwidthInternational').value, 10);

            let numberVM = parseInt(document.getElementById('numberVM').value, 10);
            let backupcapacity = parseInt(document.getElementById('backupcapacity').value, 10);

            // Khóa tất cả các ô nhập liệu
            let inputs = document.querySelectorAll('input[type="number"], input[type="range"]');
            inputs.forEach(input => {
                input.setAttribute('disabled', true);
            });

            // Hiển thị giá trị trong div #result
            let vCPU_Usage = parseFloat((numVCPU * 0.2).toFixed(1));
            let RAM_Usage = parseFloat((numRAM * 0.2).toFixed(1));
            let SSD_Usage = parseFloat(((numSSD + numRAM) * 1.33).toFixed(1));
            let HDD_Usage = parseFloat(((numHDD + backupcapacity) * 1.33).toFixed(1));
            let BTTN_Usage = parseFloat((bandwidthDomestic / 5).toFixed(1));
            let BTQT_Usage = parseFloat((bandwidthInternational / 2.7).toFixed(1));

            // Tính toán chiếm dụng hệ thống
            let vCPU_Calc = parseFloat((vCPU_Usage / 80).toFixed(2));
            let RAM_Calc = parseFloat((RAM_Usage / 512).toFixed(2));
            let SSD_Calc = parseFloat((numSSD / 10480).toFixed(2));

            let vCPU_Calc_Round = Math.ceil(vCPU_Usage / 80);
            let RAM_Calc_Round = Math.ceil(RAM_Usage / 512);
            let SSD_Calc_Round = Math.ceil(numSSD / 10480);

            let vCPU_Calc_Percent = parseFloat((vCPU_Usage / (80 * vCPU_Calc_Round)).toFixed(2));
            let RAM_Calc_Percent = parseFloat((RAM_Usage / (512 * RAM_Calc_Round)).toFixed(2));
            let SSD_Calc_Percent = parseFloat((SSD_Usage / (10480 * SSD_Calc_Round)).toFixed(2));

            let maxServerUsage = Math.max(vCPU_Calc_Round, RAM_Calc_Round, SSD_Calc_Round);
            let maxServerUsagePercent = parseFloat((Math.max(vCPU_Calc_Percent, RAM_Calc_Percent, SSD_Calc_Percent) * 100)).toFixed(2);
            let corelicmax = Math.max(vCPU_Calc, RAM_Calc, SSD_Calc);
            let corelic = (corelicmax * 32)

            let dongiaserver = 579607000;
            let capexcompute = (maxServerUsage * maxServerUsagePercent * dongiaserver)
            let capexmgmt = parseFloat((maxServerUsage * maxServerUsagePercent * 8.75 / 100 ).toFixed(2));
            let capexmgmtprice = (6626427520 * capexmgmt);

            let HDD_SAN_percent = parseFloat(((HDD_Usage / 540672) * 100).toFixed(2));
            let HDD_SAN_price = (1200000000 * HDD_SAN_percent);

            let bttnprice = (BTTN_Usage * 15625);
            let btqtnprice = (BTQT_Usage * 126000);
            let ipprice = (numIPPublic * 100000);
            let rack_calc = (maxServerUsage * maxServerUsagePercent * (4.76 / 100));
            let rack_price = ((rack_calc * 19000000) / 100);
            let licprice = (corelic * 620000);
            let opexprice = (bttnprice + btqtnprice + ipprice + rack_price + licprice);
            let veeamprice = (numberVM * 11 * 26000);


            document.getElementById('result').innerHTML = `
                <div class="total-resources">
                    <div class="tong-tai-nguyen">
                        <h3>TỔNG TÀI NGUYÊN</h3>
                        <ul>
                            <li><strong>Số lượng vCPU:</strong> ${numVCPU} GHz</li>
                            <li><strong>Số lượng RAM:</strong> ${numRAM} GB</li>
                            <li><strong>Số lượng Storage SSD:</strong> ${numSSD + numRAM} GB</li>
                            <li><strong>Số lượng Storage HDD:</strong> ${numHDD + backupcapacity} GB</li>
                            <li><strong>Số lượng IP Public:</strong> ${numIPPublic}</li>
                            <li><strong>Băng thông trong nước:</strong> ${bandwidthDomestic} Mbps</li>
                            <li><strong>Băng thông quốc tế:</strong> ${bandwidthInternational} Mbps</li>
                        </ul>
                    </div>
                    <div class="tai-nguyen-chiem-dung">
                        <h3>TÀI NGUYÊN CHIẾM DỤNG</h3>
                        <ul>
                            <li><strong>Số lượng vCPU:</strong> ${vCPU_Usage} GHz</li>
                            <li><strong>Số lượng RAM:</strong> ${RAM_Usage} GB</li>
                            <li><strong>Số lượng Storage SSD:</strong> ${SSD_Usage} GB</li>
                            <li><strong>Số lượng Storage HDD:</strong> ${HDD_Usage} GB</li>
                            <li><strong>Số lượng IP Public:</strong> ${numIPPublic}</li>
                            <li><strong>Băng thông trong nước:</strong> ${BTTN_Usage} Mbps</li>
                            <li><strong>Băng thông quốc tế:</strong> ${BTQT_Usage} Mbps</li>
                        </ul>
                    </div>
                    <div class="tai-nguyen-tinh-toan">
                        <h3>TỈ LỆ CHIẾM DỤNG</h3>
                        <ul>
                            <li><strong>Số server chiếm dụng theo CPU:</strong> ${vCPU_Calc} <strong>~~</strong> 0${vCPU_Calc_Round} server</li>
                            <li><strong>Số server chiếm dụng theo RAM:</strong> ${RAM_Calc} <strong>~~</strong> 0${RAM_Calc_Round} server</li>
                            <li><strong>Số server chiếm dụng theo vSAN:</strong> ${SSD_Calc} <strong>~~</strong> 0${SSD_Calc_Round} server</li>
                            <li><strong>Tỉ lệ server chiếm dụng theo CPU:</strong> ${(vCPU_Calc_Percent * 100).toFixed(0)}% trên tổng 0${vCPU_Calc_Round} server </li>
                            <li><strong>Tỉ lệ server chiếm dụng theo RAM:</strong> ${(RAM_Calc_Percent * 100).toFixed(0)}% trên tổng 0${RAM_Calc_Round} server</li>
                            <li><strong>Tỉ lệ server chiếm dụng theo vSAN:</strong> ${(SSD_Calc_Percent * 100).toFixed(0)}% trên tổng 0${SSD_Calc_Round} server</li>
                            <li><strong>Số lượng Core vật lý tính license:</strong> ${corelic} core</li>
                        </ul>
                    </div>
                </div>
                <div class="cost">
                    <div class="capex">
                        <h3>CHI PHÍ CAPEX</h3>
                        <ul>
                            <li style="color: #ff5733; padding: 2px; border-radius: 1px;"><strong>Số lượng Server Compute sử dụng:</strong> ${maxServerUsagePercent}% của 0${maxServerUsage} server compute</li>
                            <li style="color: #ff5733; padding: 2px; border-radius: 1px;"><strong>Chi phí CAPEX Server Compute:</strong> ${(capexcompute / 100).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #28a745; padding: 2px; border-radius: 1px;"><strong>Số lượng Server Managemet sử dụng:</strong> ${capexmgmt}% của 08 server management</li>
                            <li style="color: #28a745; padding: 2px; border-radius: 1px;"><strong>Chi phí CAPEX Server Management:</strong> ${(capexmgmtprice / 100).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #007bff; padding: 2px; border-radius: 1px;"><strong>Số lượng SAN HDD sử dụng:</strong> ${HDD_SAN_percent}% của 01 SAN HDD</li>
                            <li style="color: #007bff; padding: 2px; border-radius: 1px;"><strong>Chi phí CAPEX SAN HDD:</strong> ${(HDD_SAN_price / 100).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li><strong>Giả định số tháng khấu hao phần cứng:</strong> 36 tháng</li>
                            <li style="color: #dc3545; background-color: #f8d7da ; font-weight: bold; padding: 2px; border-radius: 1px;"><strong>TỔNG CHI PHÍ CAPEX QUY ĐỔI HÀNG THÁNG:</strong> ${(((capexcompute / 100) + (capexmgmtprice / 100) + (HDD_SAN_price / 100)) / 36).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                        </ul>
                    </div>
                    <div class="opex">
                        <h3>CHI PHÍ OPEX</h3>
                        <ul>
                            <li style="color: #ff5733; padding: 2px; border-radius: 1px;"><strong>Chi phí băng thông trong nước:</strong> ${(bttnprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #ff5733; padding: 2px; border-radius: 1px;"><strong>Chi phí băng thông quốc tế:</strong> ${(btqtnprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #28a745; padding: 2px; border-radius: 1px;"><strong>Chi phí IP Public:</strong> ${(ipprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #28a745; padding: 2px; border-radius: 1px;"><strong>Chi phí Rack:</strong> ${(rack_price).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #007bff; padding: 2px; border-radius: 1px;"><strong>Chi phí license Broadcom:</strong> ${(licprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li style="color: #007bff; padding: 2px; border-radius: 1px;"><strong>Chi phí license Veeam:</strong> ${(veeamprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                            <li><strong>Số lượng VM backup:</strong> ${numberVM} VMs</li>
                            <li style="color: #dc3545; background-color: #f8d7da ; font-weight: bold; padding: 2px; border-radius: 1px;"><strong>TỔNG CHI PHÍ OPEX:</strong> ${(opexprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                        </ul>
                    </div>
                </div>
                <div class="total">
                    <div class="total-cost">
                        <h3>TỔNG CHI PHÍ KỸ THUẬT</h3>
                        <ul>
                            <li style="color: #dc3545; font-weight: bold; padding: 2px; border-radius: 1px; text-align: center; font-size: 20px;">${((((capexcompute / 100) + (capexmgmtprice / 100) + (HDD_SAN_price / 100)) / 36) + opexprice).toLocaleString('en-US', { maximumFractionDigits: 0 })} VNĐ</li>
                        </ul>
                    </div>
                </div>
            `;

            // Bạn có thể sử dụng các biến numVCPU, numRAM, numSSD... trong các tính toán khác sau này.
        });
    </script>
</body>
</html>
